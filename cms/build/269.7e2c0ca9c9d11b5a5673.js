"use strict";(self.webpackChunkpayload_template_ts_blog=self.webpackChunkpayload_template_ts_blog||[]).push([[269],{8269:(e,t,a)=>{a.r(t),a.d(t,{default:()=>g});var i=a(67294),l=a(16550),s=a(26793),o=a(9980),n=a(28630),r=a(47489),d=a(2143),c=a(58951),u=a(58938),p=a(19826),f=a(40684),m=a(45074),$=a(91455),v=a(30894);const g=e=>{var t,a;const{collection:g,isEditing:h}=e,{slug:E,admin:{components:{views:{Edit:S}={}}={}}={}}=g,[b]=(0,i.useState)((()=>(0,u.Z)(g,h))),[k]=(0,i.useState)((()=>({...g,fields:b}))),[P,Z]=(0,i.useState)(),_=(0,f.bU)(),{serverURL:w,routes:{admin:C,api:y}}=(0,o.Z)(),{params:{id:L}={}}=(0,l.$B)(),{state:U}=(0,l.TH)(),D=(0,l.k6)(),[R,x]=(0,i.useState)(),{user:B}=(0,n.a)(),{getVersions:G,preferencesKey:H,getDocPermissions:K,docPermissions:T}=(0,m.x)(),{getPreference:V}=(0,$.G)(),{t:j}=(0,s.$)("general"),q=(0,i.useCallback)((async e=>{var t;if(G(),K(),h){const t=await(0,p.Z)({fieldSchema:k.fields,data:e.doc,user:B,id:L,operation:"update",locale:_,t:j});x(t)}else Z(`${C}/collections/${k.slug}/${null===(t=null==e?void 0:e.doc)||void 0===t?void 0:t.id}`)}),[C,k,h,G,B,L,j,_,K]),[{data:z,isLoading:A,isError:F}]=(0,r.Z)(h?`${w}${y}/${E}/${L}`:null,{initialParams:{"fallback-locale":"null",depth:0,draft:"true"}}),I=(null==U?void 0:U.data)||z;if((0,i.useEffect)((()=>{if(A)return;(async()=>{const e=await(0,p.Z)({fieldSchema:b,data:I,user:B,operation:h?"update":"create",id:L,locale:_,t:j});await V(H),x(e)})()}),[I,b,h,L,B,_,A,H,V,j]),(0,i.useEffect)((()=>{P&&D.push(P)}),[D,P]),F)return i.createElement(l.l_,{to:`${C}/not-found`});const J=`${w}${y}/${E}/${L}${k.versions.drafts?"?draft=true":""}`,M=`${w}${y}/${E}${h?`/${L}`:""}?locale=${_}&depth=0&fallback-locale=null`,N=h&&(null===(t=null==T?void 0:T.update)||void 0===t?void 0:t.permission)||!h&&(null===(a=null==T?void 0:T.create)||void 0===a?void 0:a.permission);return i.createElement(v.f.Provider,{value:1},i.createElement(d.Z,{DefaultComponent:c.Z,CustomComponent:S,componentProps:{id:L,isLoading:!R||!T,data:I,collection:k,permissions:T,isEditing:h,onSave:q,initialState:R,hasSavePermission:N,apiURL:J,action:M}}))}}}]);